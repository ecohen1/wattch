<!DOCTYPE html>
<html lang="en">

<!-- Property of ElaAdmin, this has been repurposed for Northwestern's EECS 330 class -->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="wattchfavicon.png">
    <title>Wattch</title>
    <!-- Bootstrap Core CSS -->
    <link href="css/lib/bootstrap/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->

    <link href="css/lib/calendar2/semantic.ui.min.css" rel="stylesheet">
    <link href="css/lib/calendar2/pignose.calendar.min.css" rel="stylesheet">
    <link href="css/lib/owl.carousel.min.css" rel="stylesheet" />
    <link href="css/lib/owl.theme.default.min.css" rel="stylesheet" />
    <link href="css/helper.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:** -->
    <!--[if lt IE 9]>
    <script src="https:**oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https:**oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
</head>

<body class="fix-header fix-sidebar">
    <!-- Preloader - style you can find in spinners.css -->
    <div class="preloader">
        <svg class="circular" viewBox="25 25 50 50">
			<circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10" /> </svg>
    </div>
    <!-- Main wrapper  -->
    <div id="main-wrapper">
        <!-- header header  -->
        <div class="header" style="zoom: 100%">
            <nav class="navbar top-navbar navbar-expand-md navbar-light">
                <!-- Logo -->
                <div class="navbar-header">
                    <a class="navbar-brand" href="dashboard.html">
                        <!-- Logo icon -->
                        <b><img src="wattchlogo.png" alt="homepage" class="dark-logo" height=70 width=300 style="margin: 10px"/></b>
                        <!--End Logo icon -->
                        <!-- Logo text -->
                        <!-- <span><img src="images/logo-text.png" alt="homepage" class="dark-logo" /></span> -->
                    </a>
                </div>
                <!-- End Logo -->
                <div class="navbar-collapse">
                    <!-- toggle and nav items -->
                    <!-- <ul class="navbar-nav mr-auto mt-md-0">
                        <li class="nav-item"> <a class="nav-link nav-toggler hidden-md-up text-muted  " href="javascript:void(0)"><i class="mdi mdi-menu"></i></a> </li>
                        <li class="nav-item m-l-10"> <a class="nav-link sidebartoggler hidden-sm-down text-muted  " href="javascript:void(0)"><i class="ti-menu"></i></a> </li>
                    </ul> -->
                    <!-- User profile and search -->
                    <ul class="navbar-nav my-lg-0 navaccount">
                      <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-muted  " href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img src="images/users/ad.png" alt="user" class="profile-pic" /></a>
                            <div class="dropdown-menu dropdown-menu-right animated zoomIn">
                                <ul class="dropdown-user">
                                  <li><a href="./dashboard.html"> Dashboard</a></li>
                                  <li><a href="./utilities.html"> Appliances</a></li>
                                  <li><a href="./monthlyusage.html"> Monthly Usage</a></li>
                                    <li><a href="./neighbors.html"> Neighbors</a></li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
        <!-- End header header -->

        <!-- Page wrapper  -->
        <div class="page-wrapper" style="zoom: 100%">
            <!-- Bread crumb -->
            <div class="row page-titles">
                <div class="">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="./dashboard.html">Dashboard</a></li>
                        <li class="breadcrumb-item active"><a class="currentcrumb" href='./utilities.html'>Appliances</a></li>
                    </ol>
                </div>
            </div>
            <!-- End Bread crumb -->
            <!-- Container fluid  -->
            <div class="container-fluid">

                <div class="row bg-white m-l-0 m-r-0 box-shadow">

                    <!-- column -->
                    <div class="col-lg-4">
                        <div id="donut-example-plotly">
                        </div>
                    </div>

                    <!-- column -->
                    <div class="col-lg-8">
                        <div id="extra-area-chart-plotly"></div>
                    </div>
                    <!-- column -->


                    <!-- column -->
                </div>

            </div>
            <!-- End Container fluid  -->
            <!-- footer -->
            <!-- End footer -->
        </div>
        <!-- End Page wrapper  -->
    </div>
    <!-- End Wrapper -->
    <!-- All Jquery -->
    <script src="js/lib/jquery/jquery.min.js"></script>
    <!-- Bootstrap tether Core JavaScript -->
    <script src="js/lib/bootstrap/js/popper.min.js"></script>
    <script src="js/lib/bootstrap/js/bootstrap.min.js"></script>
    <!-- slimscrollbar scrollbar JavaScript -->
    <script src="js/jquery.slimscroll.js"></script>
    <!--Menu sidebar -->
    <script src="js/sidebarmenu.js"></script>
    <!--stickey kit -->
    <script src="js/lib/sticky-kit-master/dist/sticky-kit.min.js"></script>
    <!--Custom JavaScript -->


    <!-- Amchart -->
     <script src="js/lib/morris-chart/raphael-min.js"></script>
    <script src="js/lib/morris-chart/morris.js"></script>
    <script src="js/lib/morris-chart/dashboard1-init.js"></script>
    <script src="js/lib/calendar-2/semantic.ui.min.js"></script>

<!--
	<script src="js/lib/calendar-2/moment.latest.min.js"></script>
    <script src="js/lib/calendar-2/prism.min.js"></script>
    <script src="js/lib/calendar-2/pignose.calendar.min.js"></script>
    <script src="js/lib/calendar-2/pignose.init.js"></script>-->

    <script src="js/lib/owl-carousel/owl.carousel.min.js"></script>
    <script src="js/lib/owl-carousel/owl.carousel-init.js"></script>
    <script src="js/scripts.js"></script>
    <!-- scripit init-->

    <script src="js/custom.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script type="text/javascript">
      var data = {
        'Television': [35,32,25,20,23,17,15],
        'Lights': [20,21,20,23,20,17,25],
        'AC': [8,9,12,5,7,7,10],
        'Fridge': [28,27,30,30,35,43,45],
        'XBox': [5,5,5,5,5,5,5],
      }

      var dates = ['2018-05-01','2018-05-02','2018-05-03','2018-05-04','2018-05-05','2018-05-06','2018-05-07']

      var lineChartData = [
        {
          type: "scatter",
          mode: "lines",
          name: 'Fridge',
          x: dates,
          y: data['Fridge'],
          line: {color: '#ffb64d'}
        },
        {
          type: "scatter",
          mode: "lines",
          name: 'Television',
          x: dates,
          y: data['Television'],
          line: {color: '#26DAD2'}
        },
        {
          type: "scatter",
          mode: "lines",
          name: 'Lights',
          x: dates,
          y: data['Lights'],
          line: {color: '#fc6180'}
        },
        {
          type: "scatter",
          mode: "lines",
          name: 'AC',
          x: dates,
          y: data['AC'],
          line: {color: '#62d1f3'}
        },
        {
          type: "scatter",
          mode: "lines",
          name: 'XBox',
          x: dates,
          y: data['XBox'],
          line: {color: '#4680ff'}
        }
      ]

      var layoutLine = {
        title: 'Daily Energy Usage by Appliance (kW)',
        xaxis: {
          range: ['2018-05-01', '2018-05-07'],
          type: 'date'
        },
        yaxis: {
          autorange: false,
          range: [0, 50],
          type: 'linear'
        },
        showlegend: false,
        height: 450,
        titlefont: {
          size: 20,
          color: '#475a64'
        },
      };
      Plotly.newPlot('extra-area-chart-plotly', lineChartData, layoutLine, {displayModeBar: false});

      var donutChartData = [{
        values: [
          data['Television'].reduce((a,b)=>a+b,0),
          data['Lights'].reduce((a,b)=>a+b,0),
          data['AC'].reduce((a,b)=>a+b,0),
          data['Fridge'].reduce((a,b)=>a+b,0),
          data['XBox'].reduce((a,b)=>a+b,0)
        ],
        textfont: {
          family: 'sans serif',
          size: 16,
          color: 'white'
        },
        labels: ['Television','Lights','AC','Fridge','XBox'],
        name: 'Cumulative Usage This Month',
        textinfo: 'label',
        hoverinfo: 'label',
        // hoverinfo: 'label+value+percent',
        hole: .4,
        type: 'pie',
        marker: {
          colors: [ '#26DAD2', '#fc6180', '#62d1f3', '#ffb64d', '#4680ff', '#ABC123' ],
        },
        // text: 'test',
        // textposition: 'inside',
      }];

      var layoutDonut = {
        title: 'Cumulative Usage This Month',
        showlegend: false,
        titlefont: {
          size: 20,
          color: '#475a64'
        },
        annotations: [
          {
            font: {
              size: 20
            },
            showarrow: false,
            text: '',
            x: 0.51,
            y: 0.48
          },
        ],
        // legend: {
        //   x:0,
        // },
        // annotations: [
        //   {
        //     font: {
        //       size: 20
        //     },
        //     showarrow: false,
        //     text: 'GHG',
        //     x: 0.17,
        //     y: 0.5
        //   }
        // ],
        height: 450,
        // width: 600
        };

      Plotly.newPlot('donut-example-plotly', donutChartData, layoutDonut, {displayModeBar: false});

      // $('.surface').hover((e)=>console.log(e.target))
      $('g .slice').hover((e)=>{
        var appliance = $($(e)[0].currentTarget.children[1]).html().toString().split('>')[1].split('<')[0];
        // console.log(appliance)
        // console.log($('.annotation-text')[0].innerHTML);
        console.log(donutChartData['values']);
        let values = [
          data['Television'].reduce((a,b)=>a+b,0),
          data['Lights'].reduce((a,b)=>a+b,0),
          data['AC'].reduce((a,b)=>a+b,0),
          data['Fridge'].reduce((a,b)=>a+b,0),
          data['XBox'].reduce((a,b)=>a+b,0)
        ];
        var percent = Math.floor(data[appliance].reduce((a,b)=>a+b,0) / values.reduce((a,b)=>a+b,0)*100) + '%'
        $('.annotation-text')[0].innerHTML = percent

        var filteredLineChartData = lineChartData.filter(data => data.name == appliance)
        Plotly.newPlot('extra-area-chart-plotly', filteredLineChartData, layoutLine, {displayModeBar: false});

      })

      $('g .slice').mouseleave((e)=>{
        $('.annotation-text')[0].innerHTML = ''
        Plotly.newPlot('extra-area-chart-plotly', lineChartData, layoutLine, {displayModeBar: false});
      })
    </script>

</body>

</html>
